<div
  *ngIf="widgetState === 'COLLAPSED'; else expandedTemplate"
  class="mx-auto flex max-w-sm items-center space-x-4 rounded-xl bg-white p-6 shadow-lg hover:cursor-pointer"
  (click)="widgetState = 'CHATS'"
>
  <div class="shrink-0">
    <img class="h-12 w-12" src="/assets/chat-logo.svg" alt="ChitChat Logo" />
  </div>
  <div>
    <div class="text-xl font-medium text-black">ChitChat</div>
    <p *ngIf="newMessage" class="text-slate-500">You have a new message!</p>
  </div>
</div>

<ng-template #expandedTemplate>
  <div class="mx-auto flex max-w-sm flex-col items-center space-x-4 rounded-xl bg-white shadow-lg">
    <div class="flex w-full justify-between p-3">
      <div class="text-xl font-medium text-black">ChitChat</div>
      <button class="rounded-md border-2 border-black p-1" (click)="closeChat()">X</button>
    </div>
    <ng-container *ngIf="widgetState === 'CHATS'; else singleChat">
      <div
        *ngFor="let chatInfo of visibleChats; trackBy: trackByChatShortDetails"
        class="w-64 rounded-xl bg-white py-2 px-2 shadow-lg hover:cursor-pointer sm:flex sm:items-center"
        (click)="selectChat(chatInfo)"
      >
        <img
          class="mx-auto block h-24 rounded-full sm:mx-0 sm:shrink-0"
          [src]="chatInfo.profilePic"
          alt="profile-pic"
        />
        <div class="text-center sm:text-left">
          <div class="space-y-0.5">
            <p class="text-lg font-semibold text-black">{{ chatInfo.title }}</p>
            <!-- <p class="font-medium text-slate-500">Product Engineer</p> -->
          </div>
          <!-- <button
          class="rounded-full border border-purple-200 px-4 py-1 text-sm font-semibold text-purple-600 hover:border-transparent hover:bg-purple-600 hover:text-white focus:outline-none focus:ring-2 focus:ring-purple-600 focus:ring-offset-2"
        >
          Message
        </button> -->
        </div>
      </div>
    </ng-container>
    <ng-template #singleChat>
      <div *ngFor="let message of messages; trackBy: trackByMessage">
        {{ message.from.username }} says: {{ message.content }}
      </div>
      <input
        type="text"
        placeholder="Type your answer here"
        [value]="message"
        (input)="messageChanged($any($event.target).value)"
      />
      <button (click)="sendMessage()">Send</button>
    </ng-template>
  </div>
</ng-template>
